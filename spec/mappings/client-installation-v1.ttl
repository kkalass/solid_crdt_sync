@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix crdt: <https://w3id.org/solid-crdt-sync/vocab/crdt-mechanics#> .
@prefix algo: <https://w3id.org/solid-crdt-sync/vocab/crdt-algorithms#> .
@prefix sync: <https://w3id.org/solid-crdt-sync/vocab/sync#> .
@prefix mc: <https://w3id.org/solid-crdt-sync/vocab/merge-contract#> .
@prefix mappings: <https://w3id.org/solid-crdt-sync/mappings/> .

# Standard mapping for client installation documents
# Enables collaborative lifecycle management and dormancy detection

<> a mc:DocumentMapping;
   # Import existing statement mapping for tombstones and clock mappings
   mc:imports ( mappings:core-v1 ) ;
   # Define specific mappings for client installation properties
   mc:classMapping ( <#client-installation> ) .

<#client-installation> a mc:ClassMapping;
   mc:appliesToClass crdt:ClientInstallation;
   mc:rule
     [ mc:predicate crdt:belongsToWebID; algo:mergeWith algo:Immutable ],
     [ mc:predicate crdt:applicationId; algo:mergeWith algo:Immutable ],
     [ mc:predicate crdt:createdAt; algo:mergeWith algo:Immutable ],
     [ mc:predicate crdt:lastActiveAt; algo:mergeWith algo:LWW_Register;
       rdfs:comment "Convention: Only the installation itself should update its own activity timestamp" ],
     [ mc:predicate crdt:maxInactivityPeriod; algo:mergeWith algo:LWW_Register;
       rdfs:comment "Convention: Only the installation itself should update its own inactivity threshold" ] .