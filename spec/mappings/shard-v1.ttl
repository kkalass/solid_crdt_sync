@prefix crdt: <https://w3id.org/solid-crdt-sync/vocab/crdt-mechanics#> .
@prefix algo: <https://w3id.org/solid-crdt-sync/vocab/crdt-algorithms#> .
@prefix sync: <https://w3id.org/solid-crdt-sync/vocab/sync#> .
@prefix mc: <https://w3id.org/solid-crdt-sync/vocab/merge-contract#> .
@prefix idx: <https://w3id.org/solid-crdt-sync/vocab/idx#> .
@prefix mappings: <https://w3id.org/solid-crdt-sync/mappings/> .

# CRDT mappings for shard documents
# Used by framework for shard synchronization and entry management

<> a mc:DocumentMapping;
   # Import base CRDT framework
   mc:imports ( mappings:core-v1 ) ;
   # Define shard-specific class mappings
   mc:classMapping ( <#shard> ) ;
   # Define predicate mappings for shard entry properties (since ShardEntry is not explicitly typed)
   mc:predicateMapping ( <#shard-entry-mappings> ) .

# Shard documents
<#shard> a mc:ClassMapping;
   mc:appliesToClass idx:Shard;
   mc:rule
     [ mc:predicate idx:isShardOf; algo:mergeWith algo:Immutable ],
     [ mc:predicate idx:populationState; algo:mergeWith algo:LWW_Register ],
     [ mc:predicate idx:containsEntry; algo:mergeWith algo:OR_Set ] .

# Predicate mappings for ShardEntry properties (since ShardEntry is not explicitly typed)
<#shard-entry-mappings> a mc:PredicateMapping;
   mc:rule
     [ mc:predicate idx:resource; algo:mergeWith algo:Immutable ],           # Resource IRI
     [ mc:predicate crdt:clockHash; algo:mergeWith algo:LWW_Register ] .  # Clock hash for change detection